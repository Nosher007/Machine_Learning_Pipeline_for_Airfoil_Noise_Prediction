# Airfoil Noise Prediction ML Pipeline

## Project Overview
This project implements a machine learning pipeline to predict airfoil self-noise using Apache Spark. It's designed to help aeronautics consultants efficiently predict noise levels generated by airfoils in different conditions, which is crucial for aircraft and sports car design.

## Dataset
The project uses a modified version of the NASA Airfoil Self Noise dataset, which includes measurements of:
- Frequency
- Angle of Attack
- Chord Length
- Free-Stream Velocity
- Suction Side Displacement
- Sound Level (target variable)

Dataset Source: [UCI Machine Learning Repository](https://archive.ics.uci.edu/dataset/291/airfoil+self+noise)
License: Creative Commons Attribution 4.0 International (CC BY 4.0)

## Project Structure
The project is divided into four main parts:

### 1. ETL (Extract, Transform, Load)
- Data loading from CSV
- Duplicate removal
- Null value handling
- Column renaming
- Data storage in Parquet format

### 2. Machine Learning Pipeline
- Feature assembly using VectorAssembler
- Feature scaling using StandardScaler
- Linear Regression model implementation
- Pipeline construction and training

### 3. Model Evaluation
Performance metrics achieved:
- Mean Squared Error (MSE): 22.59
- Mean Absolute Error (MAE): 3.73
- R-Squared Value: 0.54

### 4. Model Persistence
- Model saving functionality
- Model loading and verification
- Prediction generation using loaded model

## Technical Implementation
- Framework: Apache Spark
- Language: Python
- Key Libraries:
  - PySpark SQL
  - PySpark ML
  - Findspark

## Prerequisites
- Python 3.x
- PySpark 3.1.2
- Findspark

## Installation
```bash
pip install pyspark==3.1.2
pip install findspark
```

## Usage
1. Load and clean the data:
```python
# Create a SparkSession
spark = SparkSession.builder.appName("NASA AirFoil NoisePrediction").getOrCreate()

# Load and clean data
df = spark.read.csv("NASA_airfoil_noise_raw.csv", header=True, inferSchema=True)
df = df.dropDuplicates().dropna()
```

2. Create and run the pipeline:
```python
# Create pipeline stages
assembler = VectorAssembler(
    inputCols=['Frequency','AngleOfAttack','ChordLength','FreeStreamVelocity','SuctionSideDisplacement'], 
    outputCol="features"
)
scaler = StandardScaler(inputCol="features", outputCol="scaledfeatures")
lr = LinearRegression(featuresCol="scaledfeatures", labelCol="SoundLevelDecibles")

# Build and fit pipeline
pipeline = Pipeline(stages=[assembler, scaler, lr])
pipelineModel = pipeline.fit(trainingData)
```

3. Make predictions:
```python
predictions = pipelineModel.transform(testingData)

# Evaluate predictions
evaluator = RegressionEvaluator(
    predictionCol="prediction", 
    labelCol="SoundLevelDecibles", 
    metricName="rmse"
)
rmse = evaluator.evaluate(predictions)
```

## Model Performance
The model shows moderate predictive capability with:
- R-squared value of 0.54, indicating it explains 54% of the variance in sound levels
- Mean Absolute Error of 3.73 decibels
- Mean Squared Error of 22.59

## Future Improvements
- Feature engineering to capture non-linear relationships
- Experimenting with different algorithms (Random Forest, GBT)
- Hyperparameter tuning
- Cross-validation implementation

## License
This project is licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0)

## Acknowledgments
- NASA for the original dataset
- UCI Machine Learning Repository for dataset hosting